---
title: "ZHe data"
subtitle: "Data from Pikes Peak, Mt. Evans, Longs Peak"
author: "Rachel Havranek"
date: "`r format(Sys.Date(), '%d %b %Y')`"
output: 
  html_document:
    toc: yes
---
```{r setup, echo = FALSE, message=FALSE, warning=FALSE}
# load libraries
library(tidyverse) 
library(latex2exp)
library (plotly)

# global knitting options for automatic saving of all plots as .png and .pdf
knitr::opts_chunk$set(
  dev = c("png", "pdf"), fig.keep = "all",
  dev.args = list(pdf = list(encoding = "WinAnsi", useDingbats = FALSE)),
  fig.path = file.path("fig_output", paste0(gsub("\\.[Rr]md", "", knitr::current_input()), "_"))
)
```

```{r Universal data}
AFT_data <- read.csv("data/AFT_Data.csv")
model_outcomes <- read.csv ("data/Model_outcomes.csv")
```


# Pikes Peak 

### Load and Manipulate Data
```{r}
Pikes_Data <- read.csv("data/Pikes_Data_for_R .csv")

#Modify the sample names, for ease of reading, where PP still stands for Pikes Peak, and they are numbered 1 - 6 with the lowest elevation sample being 1 and highest elevation sample being 6 
Pikes_Data <- Pikes_Data %>% 
    mutate (papername = 
              ifelse(Sample == "PP2084", "PP1", #If True, add label PP2
                ifelse( Sample == "PP2479", "PP2", #If True, add label PP2
                  ifelse (Sample == "PP2907", "PP3", #If true, add label PP3
                    ifelse (Sample == "PP3597", "PP4", #If true, add label PP4
                      ifelse (Sample == "PP3971", "PP5", "PP6")     #if true, add label PP5, ELSE add the label PP6
                    )      
                  )
                )
              )
    )

Pikes_Data <- Pikes_Data %>% mutate(Peak = "Pikes Peak")
```

### Plots

This section makes plots for:   
1. Pikes Peak Elevation - date

2. Pikes Peak Date-eU  
  May 01, 2020 -- Becky and I decided to use a grey scale for the lowest three elevation samples for the Pikes Peak samples. We chose to do this because those data were previously published in Flowers et al., 2020 PNAS. I have not changed the code here, but instead I have just manually changed the colors in illustrator. I chose this approach becuase it is very hard to add two different color scales to a ggplot (they've done that on purpose).

3. Pikes Peak Elevation vs. date with each point colored by eU  
4. Pikes Peak date vs. grain size   
3. Pikes Peak AFT data (Kelley and Chapin, 2004)  
```{r Pikes Plots, echo=FALSE}
#Elevation vs. Date with each point colored by eU 
PP_ED_byeU<-ggplot (data=Pikes_Data, aes(Corr_Date, Elevation))+
  geom_errorbarh(aes(xmin=Corr_Date-Corr_date_unc, xmax=Corr_Date+Corr_date_unc), color = 'black', height=0)+
  geom_point(aes(fill=eU), shape=22, size=4)+
  viridis::scale_fill_viridis(option = "viridis", limits = c(0,2000))+
  geom_point(data=AFT_data %>% filter (Peak == "Pikes Peak"), aes(AFT_date, Elevation), pch=15, size=4)+
  theme_classic()+
  labs(x="ZHe Date (Ma)", y = "Elevation (m)", title = "Pikes Peak") +  
  scale_x_continuous(expand =c(0,0), limits=c(0,800), breaks=seq(0, 800, 200)) + 
  scale_y_continuous(expand =c(0,0), limits = c(2000,4500), breaks=seq(2000, 4500, 500))+
  theme(
   panel.border = element_rect(fill=NA, colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=12),
    axis.title.y= element_text(face="bold", size=12),
    legend.text = element_text(size = 10),
    axis.text = element_text(color = "black", size = 10), 
    #legend.position = c(.9, 0.4),
    plot.title = element_text(size = 14, hjust = 0.5))+
  guides(linetype = guide_legend(label.hjust = 0, label.vjust = 0.5, keyheight = 2))

print ("Excludes bottom two AFT samples at 1777m and 1866m")
print(PP_ED_byeU)

#Date - eU plot
PP_DeU<-ggplot (data=Pikes_Data, aes(x=eU, y=Corr_Date)) +  
  geom_errorbar(aes(ymin=Corr_Date-Corr_date_unc, ymax=Corr_Date+Corr_date_unc), color = 'black', width=.1) + 
  geom_errorbarh(aes(xmin=eU-eU_unc, xmax=eU+eU_unc)) +
  geom_point(aes(fill=Elevation), pch=22, size=4) +  
  viridis::scale_fill_viridis(option = "magma", limits = c(2000, 4500))+
  geom_vline(xintercept = 100, linetype= "dashed")  + 
  geom_vline(xintercept = 250, linetype = "dashed") +  
  geom_vline(xintercept = 500,linetype="dashed")  + 
  geom_vline(xintercept = 1000,linetype="dashed")  + 
  labs(x="eU (ppm)", y = "ZHe Date (Ma)", title = "Pikes Peak" ) +  
  scale_x_continuous(expand =c(0,0), limits=c(0,2400), breaks=seq(0, 2400, 400)) + 
  scale_y_continuous(expand =c(0,0), limits = c(0,800), breaks=seq(0, 800, 200)) +
  theme_classic() +
  theme(
    panel.border = element_rect(fill=NA, colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=12),
    axis.title.y= element_text(face="bold", size=12),
    legend.text = element_text(size = 10),
    axis.text = element_text(color = "black", size = 10), 
    plot.title = element_text(size = 14, hjust = 0.5))+
  guides(linetype = guide_legend(label.hjust = 0, label.vjust = 0.5, keyheight = 2))

print(PP_DeU)



#Grain size w/ color as Elevation 
PP_grainsize_elev<-ggplot (data=Pikes_Data, aes(r, Corr_Date))+
  geom_errorbar(aes(ymin=Corr_Date-Corr_date_unc, ymax=Corr_Date+Corr_date_unc), color = 'black', width=.1) + 
  geom_point (aes(fill=Elevation), shape=22, size =4)+
  viridis::scale_fill_viridis(option = "magma", limits = c(2000, 4500))+
  theme_classic()+
  scale_y_continuous(expand =c(0,0), limits = c(0,800), breaks=seq(0, 800, 200)) +
  scale_x_continuous(expand =c(0,0), limits=c(0,140), breaks=seq(0, 140, 30)) + 
  labs(x="Grain Size", y = "Date", title = "Date vs. Grain Size, colored by elevation") +  
  theme(
    panel.border=element_rect(fill=NA, size = 1),
    text = element_text(size = 12),
    legend.position = "none",
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.text = element_text(color = "black", size = 12)) +
  guides(linetype = guide_legend(label.hjust = 0, label.vjust = 0.5, keyheight =2))+
  theme(plot.title = element_text(size = 14, hjust = 0.5))

print(PP_grainsize_elev)

#Grain size vs. eU 
PP_grainsize_eU<-ggplot (data=Pikes_Data, aes (r, eU))+
  geom_errorbar(aes(ymin=eU-eU_unc, ymax=eU+eU_unc)) +
  geom_point (aes(fill=Elevation), shape=22, size=4)+
  viridis::scale_fill_viridis(option = "magma", limits = c(2000, 4500))+
  theme_classic()+
  scale_x_continuous(expand =c(0,0), limits = c(0,140), breaks=seq(0, 140, 30)) +
  scale_y_continuous(expand =c(0,0), limits=c(0,2400), breaks=seq(0, 2400, 400)) + 
  labs(x="Grain size (µm)", y = "eU", title = "eU vs. Grain Size, colored by elevation") +  
  theme(
    panel.border=element_rect(fill=NA,size = 1),
    text = element_text(size = 12),
    legend.position = "none", 
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.text = element_text(color = "black", size = 12)) +
  guides(linetype = guide_legend(label.hjust = 0, label.vjust = 0.5, keyheight = 2))+
  theme(plot.title = element_text(size = 14, hjust = 0.5))

print(PP_grainsize_eU)

# #AFT data
# PPAFT<-ggplot(data=Pikes_AFT, aes(x=AFT_date, y=Elevation))+
#   geom_point(pch=0, size=3)+
#   geom_errorbarh(data=Pikes_AFT, aes(xmin=(AFT_date-date_error), xmax=(AFT_date+date_error), height=0))+
#   scale_x_continuous(limits=c(0,800), breaks=seq(0, 800, 200)) + 
#   scale_y_continuous(limits = c(2000,4500), breaks=seq(2000, 4500, 500)) +
#   labs(x="ZHe Date (Ma)", y="Elevation (m)") +
#   theme_classic(axis.title.x = element_text(face="bold", size=10), 
#     axis.title.y=element_text(face="bold", size=10), 
#     axis.text = element_text(colour = "black"),
#     legend.position = c(.85, 0.75))


```


### Hefty Inputs 
**Grains excluded from models:**  
  * Sample: PP1, grain:Z32, rownumber: 6 - this grain has an eU of 151.5 and a date of 312.9, which is ~ 300 Ma younger than grains w/ comprable eU  
  * Sample: PP6, grain: Z3, rownumber: 30 - this grain had an eU of 802.5 and a date of 414, which an outlier from the rest of the bin. 
  
We have setaparated the data into two groups for modeling - below 3500 m, and above 3500 m. This separates the data that were previously published by Flowers et al., 2020 PNAS, with the new data presented here. We have chosen the same elevation cutoff for separting the three datasets for all three peaks. The bins I have here mimic those in Flowers et al., 2020 PNAS. 

**Bins:**  
* 0 - 250 ppm   (this previously was 0 - 100  + 100 - 250, but the kintetic model had a hard time with a positive Date - eU trend)
* 250 - 600 ppm  This is different than before so that we don't force a positive date-eU trend from the 0 - 250, 250 - 500 bins for the high elevation model 
* 500 - 1000 ppm  
* 1000 - 2500 ppm  
  
  
*Previously tried data binning methods:*  
* 0 - 250 ppm   (this previously was 0 - 100  + 100 - 250, but the kintetic model had a hard time with a positive Date - eU trend)
* 250 - 500 ppm  
* 500 - 1000 ppm  
* 1000 - 2500 ppm 


This approach was disgarded because we decided to model the data in two groups  

I have divided by data into 5 bins with roughly equal number of grains:
* 0 - 150 ppm (7 grains)
* 150 - 350 ppm (6 grains)
* 350 - 500 ppm (6 grains)
* 500 - 900 ppm (7 grains)
* 900 - 2500 ppm (5 grains)

I have chosen to model all of the samples together because they form a singular date-eU trend. I like the bins I have chosen here becuase I think they accurately capture the overall date - eU span.
- 670.04, eU = 102.46  
- 627.27, eU = 250.52  
- 288.52, eU = 447.82  
- 264.16, eU = 676.41  
- 140.76, eU = 1323.12  

 

```{r}
grains.not.modeled <- c(6, 30)

Pikes_Data <- Pikes_Data %>%  
  mutate( 
    Rownumber= row_number(),
    Donotuse = (Rownumber %in% grains.not.modeled),
    bindata= cut(eU, c(0, 250,600,1000,2500)) #these are my bin cutoffs
  ) 
```

Here I calculate the parapmeters I will need for my hefty model input. This automatically saves to a CSV in my data_output folder, and can be easily accessed and shared 


```{r, echo = FALSE}
Pikes_lowelevation_hefty <- Pikes_Data %>% filter (papername == "PP1" | papername == "PP2" | papername == "PP3") %>% filter (!Donotuse) %>% 
  group_by(bindata) %>% 
    summarize( 
      U = round (mean(U), digits = 1),
      Th = round (mean(Th), digits = 1),
      Sm = round (mean(Sm), digits = 1),
      RawDate_mean =  round (mean(Raw_date), digits = 1),
      Rawdate_15percent = round (0.15*mean(Raw_date), digits = 1),
      Rawdate_SD = round (sd(Raw_date), digits = 1),
      mean_rs = round(mean(r), digits = 1),
      CorrDate_mean = round(mean(Corr_Date), digits = 1),
      CorrDate_15percent = round(0.15*mean(Corr_Date),digits = 1),
      CorrDate_SD = round (sd(Corr_Date), digits = 1),
      model_uncertainty = pmax(CorrDate_15percent, CorrDate_SD, na.rm = TRUE),
      N = n(),
      eU = round (mean(eU), digits = 1),
      He = round (mean(He), digits = 1),
      FT = round (mean(FT), digits = 2),
      )

print(Pikes_lowelevation_hefty)
write.csv(Pikes_lowelevation_hefty , file="data_output/Pikes Low Elevation Hefty Flatlist.csv")

Pikes_highelevation_hefty <- Pikes_Data %>% filter (papername != "PP1" & papername != "PP2" & papername != "PP3") %>% filter (!Donotuse) %>% 
  group_by(bindata) %>% 
    summarize( 
      U = round (mean(U), digits = 1),
      Th = round (mean(Th), digits = 1),
      Sm = round (mean(Sm), digits = 1),
      RawDate_mean =  round (mean(Raw_date), digits = 1),
      Rawdate_15percent = round (0.15*mean(Raw_date), digits = 1),
      Rawdate_SD = round (sd(Raw_date), digits = 1),
      mean_rs = round(mean(r), digits = 1),
      CorrDate_mean = round(mean(Corr_Date), digits = 1),
      CorrDate_15percent = round(0.15*mean(Corr_Date),digits = 1),
      CorrDate_SD = round (sd(Corr_Date), digits = 1),
      model_uncertainty = pmax(CorrDate_15percent, CorrDate_SD, na.rm = TRUE),
      N = n(),
      eU = round (mean(eU), digits = 1),
      He = round (mean(He), digits = 1),
      FT = round (mean(FT), digits = 2),
      )

print(Pikes_highelevation_hefty)
write.csv(Pikes_highelevation_hefty, file="data_output/Pikes High Elevation Hefty Flatlist.csv")
```

```{r, include = FALSE}
#If you need to manipulate the Pikes Peak Data more after this code chunk, you should ungroup it - but I have this line commented out, becuase I don't like that it prints all the data again 
ungroup(Pikes_Data) 
```

This is a dynamic plot that can be zoomed in on, and if you hover over a data point, you can see what grain it is

```{r, echo = FALSE, warning= FALSE}
Pikes_lowelevation_heftyplt<- ggplot () + 
  geom_point(data=Pikes_Data %>% filter (papername == "PP1" | papername == "PP2" | papername == "PP3"), aes(x=eU, y=Corr_Date, label = papername, text = Grain),  fill = 'gray60', pch=22, size=4) + 
  geom_errorbar(data = Pikes_lowelevation_hefty, aes(x=eU, ymin = CorrDate_mean - model_uncertainty, ymax = CorrDate_mean + model_uncertainty), color = 'black', width=.1) +
  geom_point(data = Pikes_lowelevation_hefty, aes(x = eU, y = CorrDate_mean), pch = 21, size = 6, fill = 'dodgerblue')+
  geom_point(data = model_outcomes %>% filter(Peak == "Pikes") %>% filter(data_subset == "LOW"), aes(x = eU, y=model_date), pch =25, size = 6, fill = 'magenta' ) +
  geom_vline(xintercept = 250, linetype = "dashed") +  
  geom_vline(xintercept = 500,linetype="dashed")  + 
  geom_vline(xintercept = 1000,linetype="dashed")  + 
  labs(x="eU (ppm)", y = "ZHe Date (Ma)", title = "Pikes Peak Low Elevation Samples (< 3500 m)" ) +  
  scale_x_continuous(expand =c(0,0), limits=c(0,2400), breaks=seq(0, 2400, 400)) + 
  scale_y_continuous(expand =c(0,0), limits = c(0,800), breaks=seq(0, 800, 200)) +
  theme_classic()+
  theme(
   panel.border = element_rect(fill=NA, colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=12),
    axis.title.y= element_text(face="bold", size=12),
    legend.text = element_text(size = 10),
    axis.text = element_text(color = "black", size = 10),
   plot.title = element_text(size = 14, hjust = 0.5))

ggplotly(Pikes_lowelevation_heftyplt, dynamicTicks = TRUE)  
```


This is a dynamic plot that can be zoomed in on, and if you hover over a data point, you can see what grain it is
```{r, echo = FALSE, warning= FALSE}
Pikes_highelevation_heftyplt<- ggplot () + 
  geom_point(data=Pikes_Data %>%  filter (papername != "PP1" & papername != "PP2" & papername != "PP3"), aes( x=eU, y=Corr_Date, label = papername, text = Grain), fill = 'gray60', pch=22, size=4, ) + 
  geom_errorbar(data = Pikes_highelevation_hefty, aes(x=eU, ymin = CorrDate_mean - model_uncertainty, ymax = CorrDate_mean + model_uncertainty), color = 'black', width=.1) +
  geom_point(data = Pikes_highelevation_hefty, aes(x = eU, y = CorrDate_mean), pch = 21, size = 6, fill = 'dodgerblue') +
  geom_point(data = model_outcomes %>% filter(Peak == "Pikes") %>% filter(data_subset == "HIGH"), aes(x = eU, y=model_date), pch =25, size = 6, fill = 'magenta' ) +
  geom_vline(xintercept = 250, linetype = "dashed") +  
  geom_vline(xintercept = 600,linetype="dashed")  + 
  geom_vline(xintercept = 1000,linetype="dashed")  + 
  labs(x="eU (ppm)", y = "ZHe Date (Ma)",  title = "Pikes Peak High Elevation Samples (>3500 m)" ) +  
  scale_x_continuous(expand =c(0,0), limits=c(0,2400), breaks=seq(0, 2400, 400)) + 
  scale_y_continuous(expand =c(0,0), limits = c(0,800), breaks=seq(0, 800, 200)) +
  theme_classic()+
  theme(
   panel.border = element_rect(fill=NA, colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=12),
    axis.title.y= element_text(face="bold", size=12),
    legend.text = element_text(size = 10),
    axis.text = element_text(color = "black", size = 10),
   plot.title = element_text(size = 14, hjust = 0.5))

ggplotly(Pikes_highelevation_heftyplt, dynamicTicks = TRUE)  
```

```{r, include= FALSE}
print(Pikes_highelevation_heftyplt)
print(Pikes_lowelevation_heftyplt)
```



# Mount Evans 
### Load and Manipulate Data
```{r}
#Read in data (same format, with modified headers, as what will be published)
Mount_Evans <- read.csv("data/Evans Data.csv")

#Add a column with the sample names from original collection. 

Mount_Evans <- Mount_Evans %>% mutate(
  collection.name = ifelse (Sample == "ME1_2872", "ME10-16", 
                ifelse (Sample == "ME2_3596", "ME8-16",
                  ifelse (Sample == "ME3_3978", "ME3-16", 
                          "ME1-16")
                )
              )
            )

#Add in a column with sample elevation
Mount_Evans <- Mount_Evans %>% mutate(
  Elevation = ifelse (Sample == "ME1_2872", 2872,
                ifelse (Sample == "ME2_3596", 3596,
                  ifelse (Sample == "ME3_3978", 3978, 
                          4345)
                )
              )
            )

Mount_Evans <- Mount_Evans %>% mutate(Peak = "Mount Evans")
```

### Plots 
```{r ME_plots, echo= FALSE, warning= FALSE}
#Date eU plot, clipped to be all the same axis as other two peaks
ME_DeU<-ggplot (data=Mount_Evans, aes(x=eU, y=Corr_Date)) + 
  geom_errorbar(aes(ymin=Corr_Date-Corr_date_unc, ymax=Corr_Date+Corr_date_unc), color = 'black', width=.1) + 
  geom_errorbarh(aes(xmin=eU-eU_unc, xmax=eU+eU_unc)) +
  geom_vline(xintercept = 500, linetype = "dashed") +  
  geom_vline(xintercept = 1000,linetype="dashed")  + 
  geom_point(aes(fill=Elevation), pch=24, size=4) +  
  viridis::scale_fill_viridis(option = "magma", limits = c(2000,4500))+
  labs(x="eU (ppm)", y = "ZHe Date (Ma)", title = "Mt. Evans" ) +  
  scale_x_continuous(expand=c(0,0), limits=c(0,2400), breaks=seq(0, 2400, 400)) + 
  scale_y_continuous(expand=c(0,0), limits = c(0,800), breaks=seq(0, 800, 200)) +
  theme_classic() +
  theme(
    panel.border = element_rect(fill=NA, colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=12),
    axis.title.y= element_text(face="bold", size=12),
    legend.text = element_text(size = 10),
    axis.text = element_text(color = "black", size = 10), 
    legend.position = "none",
    plot.title = element_text(size = 14, hjust = 0.5))
print("Excludes the two highest eU data points")

#Date eU plot, with all data points
ME_DeU_full<-ggplot (data=Mount_Evans, aes(x=eU, y=Corr_Date)) + 
  geom_errorbar(aes(ymin=Corr_Date-Corr_date_unc, ymax=Corr_Date+Corr_date_unc), color = 'black') + 
  geom_errorbarh(aes(xmin=eU-eU_unc, xmax=eU+eU_unc), height=0) +
  geom_point(aes(fill=Elevation), pch=24, size=1) +  
  viridis::scale_fill_viridis(option = "magma",  limits = c(2000,4500))+
  labs(x="eU (ppm)", y = "ZHe Date (Ma)") +  
  scale_x_continuous(expand=c(0,0), limits=c(0,6600), breaks=seq(0, 6600, 3000)) + 
  scale_y_continuous(expand=c(0,0), limits = c(0,800), breaks=seq(0, 800, 400)) +
  theme_classic() +
  theme(
    panel.border = element_rect(fill=NA, colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=6),
    axis.title.y= element_text(face="bold", size=6),
    legend.text = element_text(size = 6),
    axis.text = element_text(color = "black", size = 8), 
    legend.position = "none"
    )

# Elevation vs. Date plot
ME_ED_byeU<-ggplot (data=Mount_Evans, aes(Corr_Date, Elevation))+
  geom_errorbarh(aes(xmin=Corr_Date-Corr_date_unc, xmax=Corr_Date+Corr_date_unc), color = 'black', height=0)+
  geom_point(aes(fill=eU), shape=24, size=3)+
  viridis::scale_fill_viridis(option = "viridis", limits=c(0,2000))+
  geom_point(data=AFT_data %>% filter (Peak == "Mount Evans"), aes(AFT_date, Elevation), pch=17, size=3)+
  theme_classic()+
  labs(x="ZHe Date (Ma)", y = "Elevation (m)", title = "Mount Evans") +  
  scale_x_continuous(expand =c(0,0), limits=c(0,800), breaks=seq(0, 800, 200)) + 
  scale_y_continuous(expand =c(0,0), limits = c(2000,4500), breaks=seq(2000, 4500, 500))+
  theme(
    panel.border = element_rect(fill=NA, colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=10),
    axis.title.y= element_text(face="bold", size=10),
    legend.text = element_text(size = 7),
    axis.text = element_text(color = "black", size = 8), 
    legend.position = c(.9, 0.75),
    plot.title = element_text(size = 14, hjust = 0.5)
    )


# Date vs. grain size, with the points colored by elevation
ME_relev<- ggplot(data=Mount_Evans, aes(r, Corr_Date))+
  geom_errorbar(aes(ymin=Corr_Date-Corr_date_unc, ymax=Corr_Date+Corr_date_unc), color = 'black', width=.1) + 
  geom_point (aes(fill=Elevation), shape=24, size =4)+
  viridis::scale_fill_viridis(option = "magma", limits = c(2000,4500))+
  theme_classic()+
  scale_y_continuous(expand =c(0,0), limits = c(0,800), breaks=seq(0, 800, 200)) +
  scale_x_continuous(expand =c(0,0), limits=c(0,140), breaks=seq(0, 140, 30)) + 
  labs(x="Grain Size (µm)", y = "ZHe Date (Ma)", title = "Mt. Evans") +  
  theme(
    panel.border=element_rect(fill=NA,size = 1),
    text = element_text(size = 12),
    legend.position = "none", 
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.text = element_text(color = "black", size = 12),
    plot.title = element_text(size = 14, hjust = 0.5)) 
  


# eU vs. grain size, with the points colored by elevation, all data points
ME_reU_full<-ggplot (data=Mount_Evans, aes(r, eU)) + 
  geom_errorbar(aes(ymin=eU-eU_unc, ymax=eU+eU_unc)) +
  geom_point(aes(fill=Elevation), pch=24, size=1) +  
  viridis::scale_fill_viridis(option = "magma", limits = c(2000,4500))+
  labs(x="Grain Size (µm)", y = "eU (ppm)", title = "Grain size vs. eU" ) +  
  scale_y_continuous(expand=c(0,0), limits=c(0,6600), breaks=seq(0, 6600, 3000)) + 
  scale_x_continuous(expand=c(0,0), limits = c(0,140), breaks=seq(0, 140, 30)) +
  theme_classic() +
  theme(
    panel.border=element_rect(fill=NA,size = 1),
    text = element_text(size = 6),
    legend.position = "none", 
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    plot.title = element_blank(),
    axis.text = element_text(color = "black", size = 6)) 


# eU vs. grain size, with the axis locked to match other two peaks   
ME_reU<-ggplot (data=Mount_Evans, aes(r, eU)) + 
  geom_errorbar(aes(ymin=eU-eU_unc, ymax=eU+eU_unc)) +
  geom_point(aes(fill=Elevation), pch=24, size=4) +  
  viridis::scale_fill_viridis(option = "magma", limits = c(2000,4500))+
  labs(x="Grain Size (µm)", y = "eU (ppm)", title = "Grain size vs. eU" ) +  
  scale_y_continuous(expand=c(0,0), limits=c(0,2400), breaks=seq(0, 2400, 400)) + 
  scale_x_continuous(expand=c(0,0), limits = c(0,140), breaks=seq(0, 140, 30)) +
  theme_classic() +
  theme(
    panel.border=element_rect(fill=NA,size = 1),
    text = element_text(size = 12),
    legend.position = "none", 
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.text = element_text(color = "black", size = 12),
    plot.title = element_text(size = 14, hjust = 0.5)) +
  guides(linetype = guide_legend(label.hjust = 0, label.vjust = 0.5, keyheight = 2))

#Print all plots   
print(ME_DeU)
print (ME_DeU_full)
print (ME_ED_byeU)
print (ME_relev)
print(ME_reU)
print (ME_reU_full)
```


### Hefty Outputs
Here I have separated the Mount Evans data into below 3500 m, and above 3500 m. I separted it like this becuase it looks like the bottom sample (ME1) has a different date-eU trend than the other three samples. Additonally, Bryant and Naeser (1980) documented a 'roll-over' to older AFT dates at an elevation of approximatley 3500 m, and so it reasonable to expect that samples at low elevation experienced a slightly different thermal history than the high elevation samples. 

**ME1 Bins:**  
*0 - 450 ppm - we opted to combine the first two bins because we were having a hard time getting any good fits, and it was the middle bin that was hard to match
450 - 1000 ppm 

Previously: 
*0 - 250 ppm  
*250 - 500 ppm  
*500 - 1000 ppm   

**ME2, ME3, ME4 Bins:**  
*Excluded the two high-eU grains, becuase the kineteic model can't really deal with those data points  
*0 - 450 ppm -- we slightly altered the boundary of this bin as compared to all other bins to capture the grain from ME4, with an eU of 489.1 ppm and a date of 363.0 which pretty clearly falls into the higher eU population
*450 - 1000 ppm
*1000 - 2000 

*Older separation:*
Bins:  
* 0 - 400 (9 grains)  
* 400 - 700 (8 grains)  
* 700 - 1600 (5 grains)  
* 1600 - 5100 (2 grains)

Hefty outputs for the lowest sample: 
```{r, echo=FALSE}
ME1_flatlist <- Mount_Evans %>% filter (Sample == "ME1_2872") %>% 
  mutate(bindata= cut(eU, c(0, 450,1000))) %>%  #these are my bin cutoffs
  group_by(bindata) %>% 
    summarize( 
      U = round (mean(U, na.rm = FALSE), digits = 1),
      Th = round (mean(Th, na.rm = FALSE), digits = 1),
      Sm = round (mean(Sm, na.rm = FALSE), digits = 1),
      RawDate_mean =  round (mean(Raw_date, na.rm = FALSE), digits = 1),
      Rawdate_15percent = round (0.15*mean(Raw_date, na.rm = FALSE), digits = 1),
      Rawdate_SD = round (sd(Raw_date, na.rm = FALSE), digits = 1),
      mean_rs = round(mean(r, na.rm = FALSE), digits = 1),
      CorrDate_mean = round(mean(Corr_Date, na.rm = FALSE), digits = 1),
      CorrDate_15percent = round(0.15*mean(Corr_Date, na.rm = FALSE),digits = 1),
      CorrDate_SD = round (sd(Corr_Date, na.rm = FALSE), digits = 1),
      model_uncertainty = pmax(CorrDate_15percent, CorrDate_SD, na.rm = TRUE),
      N = n(),
      eU = round (mean(eU, na.rm = FALSE), digits = 1),
      He = round (mean(He, na.rm = FALSE), digits = 1),
      FT = round (mean(FT, na.rm = FALSE), digits = 2),
      )

print(ME1_flatlist)
write.csv(ME1_flatlist, file="data_output/ME1 Hefty Flatlist.csv")
```


```{r}
grains.not.modeled <- c(13, 15) #removes grains with an eU of 5086.6 ppm and 3871.2 ppm, respectively  

Mount_Evans <- Mount_Evans %>%  
  mutate( 
    Rownumber= row_number(),
    Donotuse = (Rownumber %in% grains.not.modeled),
    bindata= cut(eU, c(0,450, 1000,2000)) #these are my bin cutoffs
  ) 
```

Here I calculate the parapmeters I will need for my hefty model input. This automatically saves to a CSV in my data_output folder, and can be easily accessed and shared 

```{r, echo = FALSE}
ME_highelevation_flatlist <- Mount_Evans %>% filter (Sample != "ME1_2872") %>% 
  filter (!Donotuse) %>% 
  group_by(bindata) %>% 
    summarize( 
      U = round (mean(U), digits = 1),
      Th = round (mean(Th), digits = 1),
      Sm = round (mean(Sm), digits = 1),
      mean_rs = round(mean(r), digits = 1),
      RawDate_mean =  round (mean(Raw_date), digits = 1),
      Rawdate_15percent = round (0.15*mean(Raw_date), digits = 1),
      Rawdate_SD = round (sd(Raw_date), digits = 1),
      CorrDate_mean = round(mean(Corr_Date), digits = 1),
      CorrDate_15percent = round(0.15*mean(Corr_Date),digits = 1),
      CorrDate_SD = round (sd(Corr_Date), digits = 1),
      model_uncertainty = pmax(CorrDate_15percent, CorrDate_SD, na.rm = TRUE),
      N = n(),
      eU = round (mean(eU), digits = 2),
      He = round (mean(He), digits = 2),
      FT = round (mean(FT), digits = 2),
      )

print(ME_highelevation_flatlist)
write.csv(ME_highelevation_flatlist, file="data_output/Evans High Elevation Hefty Flatlist.csv")
```

```{r, include = FALSE}
#If you need to manipulate the Pikes Peak Data more after this code chunk, you should ungroup it - but I have this line commented out, becuase I don't like that it prints all the data again 
ungroup(Mount_Evans) 
```

This is a dynamic plot that can be zoomed in on, and if you hover over a data point, you can see what grain it is
```{r Low Elevation Mount Evans, echo = FALSE, warning= FALSE}
ME1_Hefty<- ggplot () + 
  geom_point(data=Mount_Evans %>% filter (Sample == "ME1_2872"), aes(x=eU, y=Corr_Date, label = Sample, text = Grain, ), fill = 'gray60', pch=24, size=4) + 
  geom_errorbar(data = ME1_flatlist, aes(x=eU, ymin = CorrDate_mean - model_uncertainty, ymax = CorrDate_mean + model_uncertainty), color = 'black', width=.1)+
  geom_point(data = ME1_flatlist, aes(x = eU, y = CorrDate_mean), pch = 21, size = 6, fill = 'dodgerblue') +
  geom_point(data = model_outcomes %>% filter(Peak == "Evans") %>% filter(data_subset == "LOW"), aes(x = eU, y=model_date), pch =25, size = 6, fill = 'magenta' ) +
  #geom_vline(xintercept = 250, linetype= "dashed")  + 
  geom_vline(xintercept = 450, linetype = "dashed") +  
  geom_vline(xintercept = 1000,linetype="dashed")  + 
  labs(x="eU (ppm)", y = "ZHe Date (Ma)", title = "Mount Evans < 3500 m (ME1)")  +
  scale_x_continuous(expand=c(0,0), limits=c(0,2400), breaks=seq(0, 2400, 400)) + 
  scale_y_continuous(expand=c(0,0), limits = c(0,800), breaks=seq(0, 800, 200)) +
  theme_classic() +
  theme(
    panel.border = element_rect(fill=NA, colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=12),
    axis.title.y= element_text(face="bold", size=12),
    legend.text = element_text(size = 10),
    axis.text = element_text(color = "black", size = 10), 
    legend.position = "none",
    plot.title = element_text(size = 14, hjust = 0.5))


ggplotly(ME1_Hefty, dynamicTicks = TRUE)  
print(ME1_Hefty)

```

```{r High Elevation Mount Evans, echo = FALSE, warning= FALSE}
Evans_highelevation_hefty<- ggplot () + 
  geom_point(data = Mount_Evans %>% filter (Sample != "ME1_2872") %>% filter (!Donotuse), aes(x=eU, y=Corr_Date, label = Sample, text = Grain), fill = 'gray60', pch=24, size=4)+ 
  geom_errorbar(data = ME_highelevation_flatlist, aes(x=eU, ymin = CorrDate_mean - model_uncertainty, ymax = CorrDate_mean + model_uncertainty), color = 'black', width=.1)+
  geom_point(data = ME_highelevation_flatlist, aes(x = eU, y = CorrDate_mean), pch = 21, size = 6, fill = 'dodgerblue') +
  geom_point(data = model_outcomes %>% filter(Peak == "Evans") %>% filter(data_subset == "HIGH"), aes(x = eU, y=model_date), pch =25, size = 6, fill = 'magenta' ) +
  geom_vline(xintercept = 450, linetype = "dashed") +  
  geom_vline(xintercept = 1000,linetype="dashed")  + 
  labs(x="eU (ppm)", y = "ZHe Date (Ma)", title = "Mount Evans > 3500 m")  +
  scale_x_continuous(expand=c(0,0), limits=c(0,2400), breaks=seq(0, 2400, 400)) + 
  scale_y_continuous(expand=c(0,0), limits = c(0,800), breaks=seq(0, 800, 200)) +
  theme_classic() +
  theme(
    panel.border = element_rect(fill=NA, colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=12),
    axis.title.y= element_text(face="bold", size=12),
    legend.text = element_text(size = 10),
    axis.text = element_text(color = "black", size = 10), 
    legend.position = "none",
    plot.title = element_text(size = 14, hjust = 0.5))

ggplotly(Evans_highelevation_hefty, dynamicTicks = TRUE)
print (Evans_highelevation_hefty)
```






# Longs Peak 
### Load and Manipulate Data
```{r}
Longs_Peak <- read.csv("data/Longs_Peak.csv")

#Rename sample to match other peak schema 
Longs_Peak <- Longs_Peak %>% mutate (
  papername = ifelse (Sample == "LP1", "LP7",
                ifelse (Sample == "LP2", "LP6",
                  ifelse (Sample == "LP3", "LP5",
                    ifelse (Sample == "LP4", "LP4",
                      ifelse (Sample == "LP7", "LP3",
                          ifelse(Sample == "LP5", "LP2", "LP1")
                      )
                    )
                  )
                )
              )
  )

# Add in column with sample elevation
Longs_Peak <- Longs_Peak %>% mutate (
  Elevation = ifelse (Sample == "LP1", 4343,
                ifelse (Sample == "LP2", 4121,
                  ifelse (Sample == "LP3", 4023,
                    ifelse (Sample == "LP4", 3688,
                      ifelse (Sample == "LP7", 3500,
                          ifelse(Sample == "LP5", 3383, 2835)
                      )
                    )
                  )
                )
              )
  )  

Longs_Peak <- Longs_Peak %>% mutate (Peak = "Longs Peak")
```

### Plots 


```{r LP Plots, echo=FALSE, warning=FALSE}
# Date vs. eU, with data points colored by Elevation
LP_DeU<-ggplot (data=Longs_Peak, aes(x=eU, y=Corr_Date)) + 
  geom_errorbar(aes(ymin=Corr_Date-Corr_date_unc, ymax=Corr_Date+Corr_date_unc), color = 'black', width=.1) +
  geom_errorbarh(aes(xmin=eU-eU_unc, xmax=eU+eU_unc)) +
  geom_point(aes(fill=Elevation), pch=23, size=4) +
  viridis::scale_fill_viridis(option = "magma", limits = c(2000,4500))+
  geom_vline(xintercept = 500, linetype = "dashed") + 
  geom_vline(xintercept = 1000, linetype = "dashed")  + 
  scale_x_continuous(expand=c(0,0), limits=c(0,2400), breaks=seq(0, 2400, 400)) + 
  scale_y_continuous(expand=c(0,0), limits = c(0,800), breaks=seq(0, 800, 200)) +
  theme_classic()+
  theme(
   panel.border = element_rect(fill=NA, colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=12),
    axis.title.y= element_text(face="bold", size=12),
    legend.text = element_text(size = 10),
    axis.text = element_text(color = "black", size = 10), 
    legend.position = "none",
    plot.title = element_text(size = 14, hjust = 0.5))


# Longs Peak Elevation vs. Date, colored by eU 

LP_ED_byeU<-ggplot(data=Longs_Peak, aes(Corr_Date, Elevation))+
  geom_point(data=AFT_data %>% filter (Peak == "Longs Peak "), aes(AFT_date, Elevation), pch=18, size=6)+
  geom_errorbarh(aes(xmin=Corr_Date-Corr_date_unc, xmax=Corr_Date+Corr_date_unc), color = 'black', height=0)+
  geom_point(aes(fill=eU), shape=23, size=4)+
  viridis::scale_fill_viridis(option = "viridis", limits=c(0,2000))+
  theme_classic()+
  labs(x="ZHe Date (Ma)", y = "Elevation (m)", title = "Longs Peak") +  
  scale_x_continuous(expand =c(0,0), limits=c(0,800), breaks=seq(0, 800, 200)) + 
  scale_y_continuous(expand =c(0,0), limits = c(2000,4500), breaks=seq(2000, 4500, 500))+
  theme(
    panel.border = element_rect(fill=NA,  colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=12),
    axis.title.y= element_text(face="bold", size=12),
    legend.text = element_text(size = 10),
    axis.text = element_text(color = "black", size = 10), 
    legend.position = c(.9, 0.75),
    plot.title = element_text(size = 14, hjust = 0.5)) 


# Date vs. rs, with points colored by elevation
LP_rDate<-ggplot (data=Longs_Peak, aes(r, Corr_Date))+
  geom_errorbar(aes(ymin=Corr_Date-Corr_date_unc, ymax=Corr_Date+Corr_date_unc), color = 'black', width=.1) + 
  geom_point (aes(fill=Elevation), shape=23, size =4)+
  viridis::scale_fill_viridis(option = "magma", limits = c(2000,4500))+
  theme_classic()+
  scale_y_continuous(expand =c(0,0), limits = c(0,800), breaks=seq(0, 800, 200)) +
  scale_x_continuous(expand =c(0,0), limits=c(0,140), breaks=seq(0, 140, 30)) + 
  labs(x="Grain Size (µm)", y = "ZHe Date (Ma)", title = "Longs Peak") +  
  theme(
    panel.border=element_rect(fill=NA,size = 1),
    text = element_text(size = 12),
    legend.position = "none", 
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.text = element_text(color = "black", size = 12),
    plot.title = element_text(size = 14, hjust = 0.5)) 


# eU vs. rs, with points colored by elevation
LP_reU<-ggplot (data=Longs_Peak, aes(r, eU)) + 
  geom_errorbar(aes(ymin=eU-eU_unc, ymax=eU+eU_unc)) +
  geom_point(aes(fill=Elevation), pch=23, size=4) +
  viridis::scale_fill_viridis(option = "magma", limits = c(2000,4500))+
  labs(x="Grain Size (µm)", y = "eU (ppm)", title = "Longs Peak" ) +  
  scale_y_continuous(expand=c(0,0), limits=c(0,2400), breaks=seq(0, 2400, 400)) + 
  scale_x_continuous(expand=c(0,0), limits = c(0,140), breaks=seq(0, 140, 30)) +
  theme_classic()+
  theme(
    panel.border=element_rect(fill=NA,size = 1),
    text = element_text(size = 12),
    legend.position = "none", 
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.text = element_text(color = "black", size = 12)) 

print (LP_DeU)
print(LP_ED_byeU)
print (LP_rDate)
print(LP_reU)


```

### Hefty Outputs


Just like the other two peaks, I've divided this dataset into a low elevation (<= 3500 m), and high elevation (>3500 m) groups. 


Even eU bins - I think this makes the most sense in some ways for this distribution, because it honors 'clusters' for the most part, and evenly divides the eU space. Downside: it is not particularly similar to either of the groupings from the other peaks 
**4 Bins:**
*0 - 500 
*500 - 1000  
*1000 - 2200
None of these options really meaningfully change the average dates or the uncertainties (either 15% or s.d.) in each resepctive bin. 
```{r}
grains.not.modeled <- c()
Longs_Peak <- Longs_Peak %>%  
  mutate( 
    Rownumber= row_number(),
    Donotuse = (Rownumber %in% grains.not.modeled),
    bindata= cut(eU, c(0,500, 1000, 2500)) #these are my bin cutoffs
  ) 
```
Here I calculate the parapmeters I will need for my hefty model input. This automatically saves to a CSV in my data_output folder, and can be easily accessed and shared 
```{r, echo = FALSE}
LP_highelevation_flatlist <- Longs_Peak %>% filter (Elevation > 3500) %>% 
  filter (!Donotuse) %>% 
  group_by(bindata) %>% 
    summarize(
      U = round (mean(U), digits = 1),
      Th = round (mean(Th), digits = 1),
      RawDate_mean =  round (mean(Raw_date), digits = 2),
      Rawdate_15percent = round (0.15*mean(Raw_date), digits = 2),
      Rawdate_SD = round (sd(Raw_date), digits = 2),
      mean_rs = round(mean(r), digits = 2),
      CorrDate_mean = round(mean(Corr_Date), digits = 2),
      CorrDate_15percent = round(0.15*mean(Corr_Date),digits = 2),
      CorrDate_SD = round (sd(Corr_Date), digits = 2),
      model_uncertainty = pmax(CorrDate_15percent, CorrDate_SD, na.rm = TRUE),
      N = n(),
      eU = round (mean(eU), digits = 1),
      He = round (mean(He), digits = 1),
      FT = round (mean(FT), digits = 1),
      )


print(LP_highelevation_flatlist)
write.csv(LP_highelevation_flatlist, file="data_output/Longs High Elevation Hefty Flatlist.csv")
```

```{r, echo = FALSE}
LP_lowelevation_flatlist <- Longs_Peak %>% filter (Elevation <= 3500) %>% 
  filter (!Donotuse) %>% 
  group_by(bindata) %>% 
    summarize(
      U = round (mean(U), digits = 1),
      Th = round (mean(Th), digits = 1),
      RawDate_mean =  round (mean(Raw_date), digits = 2),
      Rawdate_15percent = round (0.15*mean(Raw_date), digits = 2),
      Rawdate_SD = round (sd(Raw_date), digits = 2),
      mean_rs = round(mean(r), digits = 2),
      CorrDate_mean = round(mean(Corr_Date), digits = 2),
      CorrDate_15percent = round(0.15*mean(Corr_Date),digits = 2),
      CorrDate_SD = round (sd(Corr_Date), digits = 2),
      model_uncertainty = pmax(CorrDate_15percent, CorrDate_SD, na.rm = TRUE),
      N = n(),
      eU = round (mean(eU), digits = 1),
      He = round (mean(He), digits = 1),
      FT = round (mean(FT), digits = 1),
      )
print(LP_lowelevation_flatlist)
write.csv(LP_lowelevation_flatlist, file="data_output/Longs Low Elevation Hefty Flatlist.csv")
```

```{r, include = FALSE}
#If you need to manipulate the Pikes Peak Data more after this code chunk, you should ungroup it - but I have this line commented out, becuase I don't like that it prints all the data again 
ungroup(Longs_Peak) 
```

```{r, echo = FALSE, warning= FALSE}
Longs_highelevation_hefty<- ggplot () + 
  geom_errorbar(data = LP_highelevation_flatlist, aes(x=eU, ymin = CorrDate_mean - model_uncertainty, ymax = CorrDate_mean + model_uncertainty), color = 'black', width=.1)+
  geom_point(data=Longs_Peak %>% filter (!Donotuse) %>% filter (Elevation >3500), aes(x=eU, y=Corr_Date, label = papername, text = Grain), fill = 'gray60', pch=22, size=4) + 
  geom_point(data = LP_highelevation_flatlist, aes(x = eU, y = CorrDate_mean), pch = 21, size = 6, fill = 'dodgerblue') +
  geom_point(data = model_outcomes %>% filter(Peak == "Longs") %>% filter(data_subset == "HIGH"), aes(x = eU, y=model_date), pch =25, size = 6, fill = 'magenta' ) +
  geom_vline(xintercept = 500, linetype= "dashed")  + 
  geom_vline(xintercept = 1000, linetype = "dashed") +  
  labs(x="eU (ppm)", y = "Date (Ma)", title= "Longs Peak, elevation >3500 m") +
  scale_x_continuous(expand=c(0,0), limits=c(0,2400), breaks=seq(0, 2400, 400)) + 
  scale_y_continuous(expand=c(0,0), limits = c(0,800), breaks=seq(0, 800, 200)) +
  theme_classic() +
  theme(
    panel.border = element_rect(fill=NA, colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=12),
    axis.title.y= element_text(face="bold", size=12),
    legend.text = element_text(size = 10),
    axis.text = element_text(color = "black", size = 10), 
    legend.position = "none",
    plot.title = element_text(size = 14, hjust = 0.5))

ggplotly(Longs_highelevation_hefty, dynamicTicks = TRUE)  
print(Longs_highelevation_hefty)
```

```{r, echo = FALSE, warning= FALSE}
Longs_lowelevation_hefty<- ggplot () + 
  geom_errorbar(data = LP_lowelevation_flatlist, aes(x=eU, ymin = CorrDate_mean - model_uncertainty, ymax = CorrDate_mean + model_uncertainty), color = 'black', width=.1)+
  geom_point(data=Longs_Peak %>% filter (!Donotuse) %>% filter (Elevation  <= 3500), aes(x=eU, y=Corr_Date, label = papername, text = Grain), fill = 'gray60', pch=22, size=4) + 
  geom_point(data = LP_lowelevation_flatlist, aes(x = eU, y = CorrDate_mean), pch = 21, size = 6, fill = 'dodgerblue') +
  geom_point(data = model_outcomes %>% filter(Peak == "Longs") %>% filter(data_subset == "LOW"), aes(x = eU, y=model_date), pch =25, size = 6, fill = 'magenta' ) +
  geom_vline(xintercept = 500, linetype= "dashed")  + 
  geom_vline(xintercept = 1000, linetype = "dashed") +  
  labs(x="eU (ppm)", y = "Date (Ma)", title= "Longs Peak, elevation <= 3500 m") +
  scale_x_continuous(expand=c(0,0), limits=c(0,2400), breaks=seq(0, 2400, 400)) + 
  scale_y_continuous(expand=c(0,0), limits = c(0,800), breaks=seq(0, 800, 200)) +
  theme_classic() +
  theme(
    panel.border = element_rect(fill=NA, colour = "black", size = 1),
    axis.ticks = element_line(color="black"),
    axis.line = element_line(color = NA),
    axis.title.x = element_text(face="bold", size=12),
    axis.title.y= element_text(face="bold", size=12),
    legend.text = element_text(size = 10),
    axis.text = element_text(color = "black", size = 10), 
    legend.position = "none",
    plot.title = element_text(size = 14, hjust = 0.5))
ggplotly(Longs_lowelevation_hefty, dynamicTicks = TRUE)  
print(Longs_lowelevation_hefty)
```


# Other Plots
```{r}
CL_raman_comparison <- Pikes_Data %>% 
  filter(Sample == "PP2084") %>% 
  ggplot()+
  geom_point(aes(eU, Corr_Date, color = Grain, label = Grain))

CL_raman_comparison
```

```{r}
date_overlap_highelevation <- Pikes_Data %>% filter(papername == "PP4" | papername == "PP5" | papername == "PP6") %>% 
  bind_rows(
    Mount_Evans %>% filter (Sample == "ME2_3596" | Sample == "ME3_3978" | Sample == "ME4_4345")
  ) %>% 
  ggplot()+
  aes(x = eU, y = Corr_Date, shape = Peak)+
  scale_shape_manual(values=c(15, 17)) +
  geom_point(size = 3)+
  labs (title = "High Elevation Samples")

date_overlap_highelevation

date_overlap_lowelevation <- Pikes_Data %>% filter(papername == "PP3") %>% 
  bind_rows(
    Mount_Evans %>% filter (Sample == "ME1_2872")
  ) %>% 
  ggplot()+
  aes(x = eU, y = Corr_Date, shape = Peak)+
  scale_shape_manual(values=c(15, 17)) +
  geom_point(size = 3)+
  labs (title = "Low Elevation Samples")

date_overlap_lowelevation



```





